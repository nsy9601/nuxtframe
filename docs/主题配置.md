# 主题配置文档
## 一、预设主题说明
本系统提供 6 套预设主题，支持一键切换，状态自动缓存：
| 主题名称 | 主题值 | 适用场景 | 主色 |
| --- | --- | --- | --- |
| 蓝色专业 | blue | 通用后台系统 | #165DFF |
| 紫色科技 | purple | 科技类产品 | #7B61FF |
| 绿色生态 | green | 环保、电商类产品 | #00B42A |
| 橙色活力 | orange | 社交、内容类产品 | #FF7D00 |
| 红色警示 | red | 风控、管理类产品 | #F53F3F |
| 暗色模式 | dark | 夜间使用、大屏展示 | #1D2129 |

## 二、主题切换方式
### 1. 页面内切换
通过顶部导航栏的「主题切换」按钮，选择预设主题即可，切换后自动缓存到本地存储，页面刷新后保持状态。

### 2. 代码中切换
```typescript
import { useTheme } from '@/composables/useTheme';

const { switchTheme } = useTheme();

// 切换到紫色科技主题
switchTheme('purple');

// 重置为默认主题（蓝色专业）
resetTheme();

三、自定义主题
1. 新增预设主题
在 app/composables/useTheme.ts 的 themes 数组中添加新主题配置：
typescript
themes.value.push({
  value: 'cyan', // 主题标识（唯一）
  label: '青色清新', // 主题名称
  color: '#00C48C' // 主题主色
});
在 app/assets/styles/themes.less 中添加主题变量：
less
.theme-cyan {
  --color-primary: #00C48C;
  --color-primary-light: #E6FFFA;
  --color-primary-dark: #00A870;
  --color-secondary: #F0FFF4;
  --color-background: #FFFFFF;
  --color-background-secondary: #F7FFF9;
}
2. 自定义主题颜色
系统支持自定义主色、辅助色等，可通过 useTheme 函数的 getThemeVariables 计算属性获取当前主题变量，按需覆盖：
vue
<script setup lang="ts">
const { getThemeVariables } = useTheme();
</script>

<template>
  <div :style="getThemeVariables">
    <!-- 自定义主题样式的组件 -->
  </div>
</template>
四、主题适配规范
1. 组件开发适配
优先使用 CSS 变量（如 var(--color-primary)），而非固定颜色值
背景色使用 var(--color-background) 和 var(--color-background-secondary)
文本色使用 var(--color-text-primary) 和 var(--color-text-secondary)
边框色使用 var(--color-border)
2. 样式优先级
主题 CSS 变量优先级：自定义主题 > 预设主题 > 全局默认值
组件内样式如需覆盖主题，需使用 !important 或更具体的选择器
plaintext

### 9. docs/前后端协作规范.md
```markdown
# 前后端协作规范
## 一、模型配置规范
### 1. 模型级配置（UIConfig 字段）
#### （1）必填配置
- `model`：模型唯一标识（全局唯一，如 `SysUser`）
- `actions`：操作按钮列表（内置按钮+自定义按钮）
- `action-permission`：按钮权限绑定（格式：`按钮名=权限标识`）

#### （2）可选配置
- `action-width`：操作列宽度（默认150px）
- `search-default-count`：搜索区默认显示字段数（默认3）
- `action-label`：按钮文本自定义（默认使用内置文本）
- `action-icon`：按钮图标配置（符合 Nuxt Icon 规范）

### 2. 字段级配置（业务字段）
#### （1）基础配置
- `label`：字段显示名称（默认字段名）
- `sort`：显示权重（数值越小越靠前，默认99）
- `hidden`：全局隐藏（优先级最高，默认false）
- `table`/`form`/`detail`：各场景显隐（默认true）

#### （2）表单配置
- `type`：表单组件类型（如 `UInput`/`USelect`，默认 `UInput`）
- `rules`：校验规则（如 `required;phone`）
- `default`：新增时默认值（支持动态表达式 `{{}}`）
- `disabled`/`readonly`：禁用/只读（支持动态表达式）

#### （3）搜索配置
- `search`：启用搜索（默认false）
- `op`：搜索操作符（如 `like`/`range`，默认 `eq`）
- `search-default`：搜索默认值（支持动态表达式）

#### （4）格式化配置
- `formatter`：格式化类型（如 `datetime:YYYY-MM-DD`）
- `path`/`path-item`/`mode`：关联数据配置

## 二、接口规范
### 1. 接口清单（必需实现）
| 接口路径 | 请求方式 | 用途 | 请求参数 | 响应格式 |
| --- | --- | --- | --- | --- |
| /getuitag | GET | 获取UI标签配置 | model_name | BaseResponse<UITagField[]> |
| /getlist | POST | 获取数据列表 | model_name+分页+排序+过滤 | BaseResponse<{list: T[], total: number}> |
| /add | POST | 新增数据 | model_name+data | BaseResponse |
| /edit | POST | 编辑数据 | model_name+id+data | BaseResponse |
| /del | POST | 删除数据 | model_name+ids | BaseResponse |
| /getpermissions | GET | 获取权限列表 | 无 | BaseResponse<string[]> |

### 2. 接口通用规则
- 响应格式统一：`{ code: number, data: any, msg: string }`
- 成功标识：`code: 0`，失败标识：`code !== 0`
- 错误信息：失败时 `msg` 字段返回清晰错误原因
- 数据格式：日期字段返回时间戳（秒级），金额字段返回数字类型

### 3. 动态数据源接口（可选）
- 接口路径：自定义（通过 `api` 配置）
- 响应格式：BaseResponse<{ value: string/number, label: string, disabled?: boolean, color?: string }[]>
- 支持依赖字段联动：通过 `depend` 配置触发接口刷新

## 三、权限同步规范
### 1. 权限标识命名规则
- 格式：`模型名:操作`（如 `sysuser:view`、`product:edit`）
- 内置按钮默认权限：`view=模型名:view`、`edit=模型名:edit`、`delete=模型名:delete`、`add=模型名:add`
- 自定义按钮权限：需显式配置 `action-permission`

### 2. 权限同步流程
1. 后端新增权限标识后，需同步更新模型 `action-permission` 配置
2. 前端通过 `/getpermissions` 接口获取当前用户权限列表
3. 无权限的按钮自动隐藏，无需前端额外处理

## 四、变更同步规范
### 1. 模型配置变更
- 后端修改 `ui` 标签后，需通知前端手动清理缓存（通过调试工具或页面按钮）
- 新增字段后，需确保 `sort` 配置合理，避免显示顺序混乱
- 修改字段类型（`type`）后，需同步检查表单校验规则（`rules`）

### 2. 接口变更
- 接口路径变更：需同步更新前端 `useApi.ts` 中的接口路径
- 参数格式变更：需提前通知前端，同步修改类型定义和请求参数
- 响应格式变更：需保持 `code`/`data`/`msg` 结构不变，仅修改 `data` 内容

## 五、版本兼容规范
- 协议版本：统一使用 v2.4.0 最终版，向后兼容历史版本
- 新增配置项：需保持默认值，避免影响现有功能
- 废弃配置项：需保留兼容处理，逐步迁移至新配置