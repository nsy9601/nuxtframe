# Nuxt4 + Nuxt UI 协议驱动后台管理系统最终任务清单
## 一、核心设计原则（基于协议规范+性能优化）
1. **严格遵循协议规范**：完全对齐 UI Tag 协议 v2.4.0 所有约定，包括接口格式、标签解析、权限控制、组件映射等核心规则
2. **性能优先**：通过配置缓存、懒加载、虚拟数据预加载、按需渲染优化首页加载速度
3. **开发效率最大化**：通用组件封装+模型配置化渲染，新增业务模型无需重复编码
4. **用户体验优化**：多主题切换、响应式适配、操作记忆（每页条数、列筛选状态等）、统一交互反馈
5. **可维护性保障**：TS 类型约束、模块化拆分、规范命名与目录结构，适配长期迭代

## 二、最终任务清单（按开发优先级排序）
### 1. 基础环境与核心配置（优先级：最高）
- 初始化 Nuxt4.2.2 项目，集成依赖：@nuxt/ui、@nuxt/icon、@nuxtjs/color-mode、xlsx（Excel 导出）、zod（表单校验）
- 配置 nuxt.config.ts（根目录）：
  - 依赖注册与按需导入（优化打包体积）
  - TS 支持（类型校验、路径别名）
  - 样式配置（Tailwind 自定义、响应式断点）
  - 缓存策略（API 缓存、静态资源缓存）
  - 性能优化（组件懒加载、预取策略）
- 实现 6 套预设主题：蓝色专业、紫色科技、绿色生态、橙色活力、红色警示、暗色模式，支持主色/辅助色自定义与本地缓存
- 配置全局类型定义（types 目录）：接口响应类型、组件 Props 类型、标签配置类型等
- 性能优化配置：
  - 路由懒加载（默认开启）
  - 组件自动导入按需加载
  - 静态资源压缩与 CDN 配置
  - 首页关键资源预加载

### 2. 核心工具函数开发（TS 实现）（优先级：最高）
#### （1）协议解析工具
- useUIConfig.ts：UI 标签解析（支持协议语法规则、动态表达式、转义处理）、配置缓存（永久缓存+手动刷新）
- tagParser.ts：标签字符串解析（键值对提取、类型转换、空格兼容、空值处理）

#### （2）权限与 API 工具
- usePermissions.ts：权限列表获取与缓存、按钮权限校验（遵循 RBAC 约定）、默认权限标识映射
- useApi.ts：API 封装（完全对齐协议接口规范）、虚拟数据模拟、接口切换开关、统一错误处理（code+msg 匹配）
- mockData.ts：模拟所有核心接口返回数据（getuitag、getlist、add、edit、del、getpermissions 等），支持动态生成测试数据

#### （3）格式化与交互工具
- useFormatter.ts：日期/时间/金额/百分比/图片格式化（遵循协议格式化约定）、关联数据渲染（flat/tags/avatar-group 等模式）
- useTheme.ts：主题切换、主题缓存、自定义主题配置、样式变量注入
- useTable.ts：表格列筛选、列顺序调整、Excel 导出（仅导出当前显示数据）、每页条数切换与缓存

### 3. 全局布局与基础组件（TS + Vue SFC）（优先级：高）
#### （1）布局组件
- app/layouts/default.vue：后台管理框架（侧边栏+顶部导航+内容区），响应式适配（移动端侧边栏抽屉化）
- Sidebar.vue：主导航（模型入口、多级菜单），支持折叠/展开、权限控制显示、菜单缓存
- Navbar.vue：顶部操作栏（主题切换、全屏按钮、用户信息、通知中心、退出登录）
- PageContainer.vue：统一页面容器（面包屑、页面标题、操作区、内容区边距）

#### （2）通用交互组件
- ThemeSwitcher.vue：主题选择面板（预设主题切换、自定义颜色配置、主题预览）
- ConfirmDialog.vue：统一确认弹窗（基于 Nuxt UI 的 UDialog 封装）
- ToastPlugin.ts：全局消息提示（基于 useToast，统一成功/失败/警告样式）
- EmptyState.vue：空状态展示（表格空数据、搜索无结果、接口请求失败等场景）

### 4. 业务核心组件开发（TS + Vue SFC）（优先级：高）
#### （1）搜索栏组件（SearchBar.vue）
- 遵循协议搜索与过滤约定，支持 search:true 字段自动渲染
- 操作符适配（eq/like/range 等 12 种操作符），自动匹配对应渲染组件
- 搜索区折叠/展开（遵循 search-default-count 约定），状态记忆
- 支持搜索默认值、自定义占位符、多值搜索（in 操作符）

#### （2）表格组件（DataTable.vue）
- 遵循协议模型与字段配置，自动渲染表格列（table:true 字段）
- 支持列筛选（纯前端，勾选显示/隐藏列、列顺序调整），配置本地缓存
- 分页功能：支持页码切换、每页条数切换（10/20/50/100 可选），状态缓存
- 排序功能：支持字段升序/降序排序（遵循 sort 配置权重）
- 行操作按钮：内置按钮（view/edit/delete）+ 自定义按钮，权限控制隐藏/显示
- Excel 导出：纯前端实现，仅导出当前显示数据（含筛选后结果）
- 支持表格列固定宽度、对齐方式、溢出省略、单元格样式自定义

#### （3）动态表单组件（DynamicForm.vue）
- 遵循协议表单配置，自动渲染表单项（form:true 字段）
- 支持表单状态控制（add/edit/detail 状态下的显隐/禁用/只读）
- 数据源适配：静态枚举（options 配置）、动态 API（api/depend 配置）、混合模式
- 表单校验：解析 rules 配置，转化为 Zod 校验规则，支持多规则组合与自定义提示
- 支持表单联动（动态表达式）、栅格布局（span 配置）、自定义组件渲染

#### （4）详情页组件（DetailView.vue）
- 遵循协议 detail 配置，自动渲染详情字段（detail:true 字段）
- 支持字段格式化展示、关联数据渲染（tags/avatar-group/link 等模式）
- 支持空值占位符（empty-text 配置）、字段说明提示（tooltip 配置）

#### （5）操作按钮组件（ActionButtons.vue）
- 内置按钮（view/edit/delete/add）：遵循默认文本、图标、权限约定
- 自定义按钮：支持 action-api/action-method/action-callback 配置，按协议调用逻辑执行
- 按钮动态显示条件（action-item-condition 配置）、样式自定义（action-class 配置）
- 批量操作支持：选中数据数组传入，适配批量删除、批量审核等场景

### 5. 通用模型页面封装（TS + Vue SFC）（优先级：中）
- ModelList.vue：通用列表页组件（集成搜索栏、数据表格、分页、批量操作）
  - 支持模型配置传入，自动渲染对应页面
  - 支持搜索、重置、新增、批量删除等基础操作
- ModelCreate.vue：通用新增页组件（集成动态表单、校验逻辑、提交处理）
  - 遵循协议新增接口格式，自动携带 model_name + data 参数
- ModelEdit.vue：通用编辑页组件（集成数据回显、动态表单、编辑限制、提交处理）
  - 遵循协议编辑接口格式，自动携带 model_name + id + data 参数
- ModelDetail.vue：通用详情页组件（集成详情展示、关联数据渲染、返回按钮）

### 6. 页面开发（TS + Vue SFC）（优先级：中）
- app/pages/index.vue：系统首页（模型列表入口、系统概览、快捷操作）
- app/pages/sysuser.vue：系统用户页面（仅配置 modelName: 'sysuser'，引用 ModelList/ModelCreate 等通用组件）
- app/pages/product.vue：产品页面（示例模型页面，仅需配置模型标识）
- app/pages/[...].vue：404 页面（全局路由 fallback，友好提示与返回按钮）
- app/error.vue：全局错误页（统一错误处理，支持重试操作）

### 7. 样式开发（优先级：中）
- app/styles/main.less：全局样式补充（页面边距、通用组件样式、自定义 Tailwind 工具类）
- app/styles/themes.less：主题样式定义（6 套预设主题变量、自定义主题映射）
- app/styles/variables.less：全局 LESS 变量（颜色、间距、字体大小等）
- 响应式样式优化：适配移动端（360px+）、平板（768px+）、桌面端（1200px+），表格/表单/导航自适应调整

### 8. 性能优化与调试工具（优先级：中）
- 缓存优化：UI 标签配置缓存、权限列表缓存、表格状态缓存（每页条数、列筛选）、搜索状态缓存
- 懒加载优化：路由懒加载、组件懒加载、动态表单组件按需渲染、图片懒加载
- 调试工具：
  - debug.ts：缓存清理、配置打印、权限模拟、标签解析调试
  - apiSwitch.ts：一键切换虚拟/真实接口，支持全局配置或单接口单独配置
- 首页加载优化：
  - 关键资源预加载（核心工具函数、布局组件）
  - 非关键资源延迟加载（自定义组件、静态资源）
  - 虚拟数据预加载，避免首屏空白

### 9. 项目文档生成（优先级：低）
- 快速上手.md：环境搭建、项目启动、依赖安装、目录说明、核心配置
- 开发规范.md：TS 类型规范、组件开发规范、接口调用规范、UI Tag 配置示例
- 主题配置.md：预设主题说明、自定义主题教程、样式变量映射关系
- 前后端协作规范.md：协议对齐要点、接口格式约定、模型配置规范、权限同步规则
- 功能使用文档.md：表格列筛选、Excel 导出、主题切换、每页条数配置等用户操作说明

## 三、目录结构（严格遵循 Nuxt4 约定+协议规范）
```
nuxt-ui-tag-admin/
├── app/
│   ├── components/          # 组件目录（Nuxt4 自动导入）
│   │   ├── layout/          # 布局组件
│   │   │   ├── Sidebar.vue
│   │   │   ├── Navbar.vue
│   │   │   ├── PageContainer.vue
│   │   │   └── ThemeSwitcher.vue
│   │   ├── business/        # 业务核心组件
│   │   │   ├── SearchBar.vue
│   │   │   ├── DataTable.vue
│   │   │   ├── DynamicForm.vue
│   │   │   ├── DetailView.vue
│   │   │   └── ActionButtons.vue
│   │   ├── common/          # 通用交互组件
│   │   │   ├── ConfirmDialog.vue
│   │   │   ├── EmptyState.vue
│   │   │   └── Loading.vue
│   │   └── custom/          # 自定义组件（协议约定目录）
│   │       ├── actions/     # 自定义操作按钮
│   │       │   └── AuditAction.vue
│   │       └── ProductSelect.vue
│   ├── composables/         # 组合式函数（自动导入）
│   │   ├── useUIConfig.ts
│   │   ├── usePermissions.ts
│   │   ├── useApi.ts
│   │   ├── useFormatter.ts
│   │   ├── useTheme.ts
│   │   └── useTable.ts
│   ├── layouts/
│   │   └── default.vue      # 后台管理框架布局
│   ├── pages/
│   │   ├── index.vue        # 系统首页
│   │   ├── sysuser.vue      # 系统用户页面（配置化渲染）
│   │   ├── product.vue      # 产品页面（示例配置化页面）
│   │   └── [...].vue        # 404页面
│   ├── public/              # 静态资源
│   │   ├── icons/           # 自定义图标
│   │   └── images/          # 图片资源
│   ├── styles/              # 样式文件
│   │   ├── main.less
│   │   ├── themes.less
│   │   └── variables.less
│   ├── types/               # TS 类型定义
│   │   ├── api.ts           # 接口响应类型
│   │   ├── component.ts     # 组件 Props 类型
│   │   └── config.ts        # 标签配置类型
│   ├── utils/               # 工具函数
│   │   ├── tagParser.ts
│   │   ├── mockData.ts
│   │   ├── apiSwitch.ts
│   │   ├── debug.ts
│   │   └── exportExcel.ts   # Excel 导出工具
│   ├── app.vue              # 根组件
│   ├── error.vue            # 全局错误页
│   └── loading.vue          # 全局加载页
├── components/              # 通用模型页面组件
│   ├── ModelList.vue
│   ├── ModelCreate.vue
│   ├── ModelEdit.vue
│   └── ModelDetail.vue
├── nuxt.config.ts           # 根目录配置文件
├── package.json
├── tsconfig.json
├── tailwind.config.ts       # Tailwind 配置（扩展主题颜色、工具类）
└── docs/                    # 项目文档
    ├── 快速上手.md
    ├── 开发规范.md
    ├── 主题配置.md
    ├── 前后端协作规范.md
    └── 功能使用文档.md
```

## 四、核心特性与协议对齐说明
1. **完全遵循协议接口规范**：所有 API 调用严格对齐增删改查、标签配置、权限查询接口格式
2. **UI Tag 全量支持**：支持协议中所有标签配置项（模型级、字段级），解析逻辑完全匹配语法规则
3. **权限控制精准实现**：RBAC 权限绑定、按钮权限校验、无权隐藏等规则完全遵循协议约定
4. **组件映射一致性**：Nuxt UI 组件直接映射（UInput/USelect 等），自定义组件目录符合协议约定
5. **错误处理统一化**：仅 code:0 为成功，非 0 显示 msg 信息，完全遵循协议错误处理规则

## 五、开发与部署说明
1. **开发流程**：先搭建基础环境→开发核心工具函数→开发全局组件→封装通用模型页面→开发具体业务页面→优化性能与调试
2. **接口切换**：开发阶段使用虚拟数据（mockData.ts），后端接口就绪后通过 apiSwitch.ts 一键切换为真实接口
3. **缓存清理**：模型配置变更后，可通过调试工具手动清理缓存，确保配置实时生效
4. **部署优化**：打包时开启代码分割、静态资源压缩、CDN 加速，进一步提升页面加载速度

要不要我先开始生成基础配置文件（nuxt.config.ts、package.json、tsconfig.json），为后续开发搭建环境基础？